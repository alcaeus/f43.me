{% extends "j0k3rFeedBundle::layout.html.twig" %}
{% form_theme edit_form 'j0k3rFeedBundle:Form:_form.html.twig' %}

{% block h2_title %}
    <img class="favicon" src="https://plus.google.com/_/favicon?domain={{ feed.link }}" />
    {{ feed.name }}'s feed
{% endblock %}

{% block content %}
<div class="row">
    <div class="large-8 columns">
        <form action="{{ path('j0k3r_feed_update', { 'slug': feed.slug }) }}" method="post" {{ form_enctype(edit_form) }} class="custom">
            {{ form_widget(edit_form) }}

            <div class="row">
                <div class="small-3 columns">
                    <label class="right inline">Created</label>
                </div>
                <div class="small-9 columns">
                    <input disabled="disabled" type="text" value="{{ feed.createdat|date('Y-m-d H:i:s') }}" />
                </div>
            </div>

            <div class="row">
                <div class="small-3 columns">
                    <label class="right inline">Updated</label>
                </div>
                <div class="small-9 columns">
                    <input disabled="disabled" type="text" value="{{ feed.updatedat|date('Y-m-d H:i:s') }}" />
                </div>
            </div>

            <div class="row">
                <div class="small-9 small-offset-3 columns">
                    <button type="submit" class="small button radius success">Save</button>
                </div>
            </div>
        </form>
    </div>
    <div class="large-4 columns feed-info">
        <ul>
            <li>
                <span class="info">Api feed link</span>
                <a href="{{ url('j0k3r_feedapi_feed', { 'slug': feed.slug }) }}" target="_blank">
                    {{ url('j0k3r_feedapi_feed', { 'slug': feed.slug }) }}
                </a>
            </li>
            <li>
                <span class="info">Last cached item</span>
                <a href="{{ path('j0k3r_feeditem_homepage', { 'slug': feed.slug }) }}" title="{{ lastItem.publishedat|date('d/m/y - H:i:s') }}">
                    {{ time_diff(lastItem.publishedat) }}
                </a>
            </li>
            <li>
                <span class="info">Cached items</span>
                <a href="{{ path('j0k3r_feeditem_homepage', { 'slug': feed.slug }) }}">
                    {{ feed.feeditems.count }} items
                </a>
            </li>
            <li>
                <span class="info">Last log</span>
                <a href="{{ path('j0k3r_feedlog_feed', { 'slug': feed.slug }) }}" title="{{ lastLog.createdat|date('d/m/y - H:i:s') }}">
                    {{ time_diff(lastLog.createdat) }}
                </a>
            </li>
            <li>
                <span class="info">Logs</span>
                <a href="{{ path('j0k3r_feedlog_feed', { 'slug': feed.slug }) }}">
                    {{ feed.feedlogs.count }} items
                </a>
            </li>
        </ul>
    </div>
</div>

<div class="row">
    <div class="large-12 columns">
        <hr/>
        <ul class="inline-list">
            <li><a class="secondary button radius small" href="{{ path('j0k3r_feed_homepage') }}">&lArr; Back to the list</a></li>
            <li><a class="button radius small" data-tooltip class="has-tip" title="It can take few seconds to load" data-reveal-id="modal-test-item" data-reveal-ajax="{{ path('j0k3r_feeditem_test', { 'slug': feed.slug }) }}">Test parsing</a></li>
            <li><form action="{{ path('j0k3r_feed_delete', { 'slug': feed.slug }) }}" method="post">{{ form_widget(delete_form) }}<button class="alert button radius small" type="submit">Delete</button></form></li>
        </ul>
    </div>
</div>

<div id="modal-test-item" class="reveal-modal"></div>

{% endblock %}
